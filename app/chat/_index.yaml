version: "1.0"
namespace: app.chat

meta:
  depends_on: [ ns:app ]

entries:
  - name: client
    kind: btea.app.lua
    meta:
      comment: "AI Chat Client"
    source: file://chat.lua
    method: App
    modules: [ time, btea, channel, upstream, process ]
    imports:
      bapp: "app:bapp"
      prompt: wippy.llm:prompt
      llm: wippy.llm:llm

  - name: client.service
    kind: process.service
    meta:
      comment: "AI Chat Client Service"
    process: client
    host: app:terminal
    lifecycle:
      auto_start: true
      restart:
        initial_delay: 5s
        max_attempts: 3
      depends_on:
        - app:terminal
      security:
        actor:
          ID: chat-client
          Meta:
            role: llm-user
            service: chat
        groups:
          - wippy.security:process
